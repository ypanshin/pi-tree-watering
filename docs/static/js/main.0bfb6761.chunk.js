(this["webpackJsonppi-tree-watering-dashboard"]=this["webpackJsonppi-tree-watering-dashboard"]||[]).push([[1],{101:function(e,t,n){var a={"./ion-icon.entry.js":[243,57]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=101,e.exports=r},102:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},109:function(e,t,n){},110:function(e,t,n){},184:function(e,t,n){},185:function(e,t,n){},196:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(45),o=n.n(l),c=n(1),i=n(23),s=n(10),m=(n(102),[{title:"Dashboard",url:"dashboard",iosIcon:s.a,mdIcon:s.b},{title:"Logs",url:"logs",iosIcon:s.q,mdIcon:s.r},{title:"Configuration",url:"config",iosIcon:s.j,mdIcon:s.k}]),u=[{title:"About",url:"about",iosIcon:s.l,mdIcon:s.m}],d=function(){var e=Object(i.e)();return r.a.createElement(c.p,{contentId:"main",type:"overlay"},r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.z,null,"PI Tree Watering System"),r.a.createElement(c.c,{slot:"end"},r.a.createElement(c.b,{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/ypanshin/rpi-tree-watering"},r.a.createElement(c.k,{slot:"icon-only",ios:s.n,md:s.n}))))),r.a.createElement(c.i,null,r.a.createElement(c.o,null,m.map((function(t,n){return r.a.createElement(c.r,{key:n,autoHide:!1},r.a.createElement(c.m,{className:e.pathname===t.url?"selected":"",routerLink:t.url,routerDirection:"none",lines:"none",detail:!1},r.a.createElement(c.k,{slot:"start",ios:t.iosIcon,md:t.mdIcon}),r.a.createElement(c.n,null,t.title)))}))),r.a.createElement(c.o,null,u.map((function(t,n){return r.a.createElement(c.r,{key:n,autoHide:!1},r.a.createElement(c.m,{className:e.pathname===t.url?"selected":"",routerLink:t.url,routerDirection:"none",lines:"none",detail:!1},r.a.createElement(c.k,{slot:"start",ios:t.iosIcon,md:t.mdIcon}),r.a.createElement(c.n,null,t.title)))})))))},E=n(9),f=n.n(E),p=n(18),v=n(17),h=n(24),j=function(e){var t=e.storageParameter,n=e.error,l=e.onSave,o=Object(a.useState)({showBoxIdForm:!t||!!n,storageParameter:t}),i=Object(h.a)(o,2),s=i[0],m=i[1];Object(a.useEffect)((function(){m((function(e){var a=Object(p.a)({},e);return n&&(a.showBoxIdForm=!0),Object(p.a)(Object(p.a)({},a),{},{storageParameter:t})}))}),[n,t]);return r.a.createElement(c.s,{isOpen:s.showBoxIdForm,backdropDismiss:!1},r.a.createElement(c.t,null,r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.z,null,"Storage Parameter"),r.a.createElement(c.c,{slot:"end"},r.a.createElement(c.b,{onClick:function(){s.storageParameter&&(m(Object(p.a)(Object(p.a)({},s),{},{showBoxIdForm:!1})),l(s.storageParameter))}},"Save")))),r.a.createElement(c.i,{className:"ion-padding"},r.a.createElement("p",null,"This application is client for Pi tree watering system."),r.a.createElement(c.o,null,r.a.createElement(c.m,null,r.a.createElement(c.n,{position:"floating"},"Enter Storage Parameter"),r.a.createElement(c.l,{value:s.storageParameter,onIonChange:function(e){return function(e){m(Object(p.a)(Object(p.a)({},s),{},{storageParameter:e}))}(e.detail.value)},required:!0,clearInput:!0}))),function(e){if(e)return r.a.createElement(c.y,{color:"danger"},r.a.createElement("p",null,"Error while getting data ",e.status))}(n))))},g=n(5),y=n(6),b=n(85),w=n.n(b),O=function(){function e(t){Object(g.a)(this,e),this.url=t}return Object(y.a)(e,[{key:"get",value:function(){return w()(this.url,{headers:{"ngrok-skip-browser-warning":"skip"}}).then((function(e){if(e.ok)return e.json();var t=e.status,n=e.statusText;return Promise.reject({status:t,statusText:n})}))}}]),e}(),k={loading:!0,parameter:localStorage.getItem("storageParameter")||void 0},I=Object(a.createContext)(k);function x(e){var t=Object(a.useState)(k),n=Object(h.a)(t,2),l=n[0],o=n[1];Object(a.useEffect)((function(){if(l.parameter){var e=new O(l.parameter),t=function(){var n=Object(v.a)(f.a.mark((function n(){var a,r,l,c,i,s;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.get();case 3:a=n.sent,r=2e3,a.config&&a.config.onInterval&&(l=a.config,c=l.offInterval,i=l.onInterval,r=r>(s=c<i?c:i)?r:s,o((function(e){return Object(p.a)(Object(p.a)({},e),{},{loading:!1,log:a,lastUpdated:Date.now()})}))),setTimeout(t,r),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),console.error("error while getting logs",n.t0),o((function(e){return Object(p.a)(Object(p.a)({},e),{},{parameter:void 0,error:n.t0})}));case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}();t()}}),[l.parameter]);return r.a.createElement("div",null,r.a.createElement(j,{storageParameter:l.parameter,error:l.error,onSave:function(e){localStorage.setItem("storageParameter",e),o((function(t){return Object(p.a)(Object(p.a)({},t),{},{parameter:e,error:void 0})}))}}),r.a.createElement(I.Provider,{value:l},e.children))}I.Consumer,n(107);var N,_=function(e){var t=Object(a.useState)({seconds:-1}),n=Object(h.a)(t,2),l=n[0],o=n[1];return Object(a.useEffect)((function(){var t=e.lastUpdated?Math.round((Date.now()-e.lastUpdated)/1e3):-1;o({seconds:t}),N&&clearInterval(N),-1!==t&&(N=setInterval((function(){o((function(e){return{seconds:e.seconds+1}}))}),1e3))}),[e.lastUpdated]),r.a.createElement("div",{className:"last-updated"},-1===l.seconds?"":"Updated ".concat(l.seconds," sec ago"))},P=function(e){var t=e.onTime?"".concat(Math.round(e.onTime/1e3)):"NA";return r.a.createElement("h1",null,t," Sec")},T=function(){return r.a.createElement(c.w,{animated:!0,style:{width:"100%"}})},S=n(48),D=n.n(S),U=function(e){var t=e.startDate,n="";if(t){var a=function(e,t){return String(e).padStart(t,"0")},l=D()(),o=l.diff(t,"hours"),c=l.subtract(o,"hours").diff(t,"minutes");o>0&&(n="".concat(a(o,2)," Hours ")),n+="".concat(a(c,2)," Min")}else n="NA";return r.a.createElement("h1",null,n)},A=function(e){var t=e.onTime,n=e.pumpFlow,a="NA";return t&&n&&(a="".concat(Math.round(t/6e4*n*1e3)/1e3)),r.a.createElement("h1",null,a," Litters")},C=(n(108),function(){var e,t=Object(a.useContext)(I),n=t.loading,l=t.lastUpdated,o=t.log;return r.a.createElement(c.t,null,r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.c,{slot:"start"},r.a.createElement(c.q,null)),r.a.createElement(c.z,null,"Dashboard"),r.a.createElement("div",{slot:"end"},r.a.createElement(_,{lastUpdated:l})))),r.a.createElement(c.i,{fullscreen:!0},r.a.createElement(c.d,null,r.a.createElement(c.f,null,r.a.createElement(c.g,null,"The pump run time"),r.a.createElement(c.h,null,"Pump Run")),r.a.createElement(c.e,null,n?r.a.createElement(T,null):r.a.createElement(P,{onTime:null===o||void 0===o?void 0:o.onTime}))),r.a.createElement(c.d,null,r.a.createElement(c.f,null,r.a.createElement(c.g,null,"The water transferred"),r.a.createElement(c.h,null,"Water")),r.a.createElement(c.e,null,n?r.a.createElement(T,null):r.a.createElement(A,{onTime:null===o||void 0===o?void 0:o.onTime,pumpFlow:null===o||void 0===o||null===(e=o.config)||void 0===e?void 0:e.pumpFlow}))),r.a.createElement(c.d,null,r.a.createElement(c.f,null,r.a.createElement(c.g,null,"The system runs for"),r.a.createElement(c.h,null,"Run Hours")),r.a.createElement(c.e,null,n?r.a.createElement(T,null):r.a.createElement(U,{startDate:null===o||void 0===o?void 0:o.startDate})))))}),F=n(86),M=n.n(F),B=function(e){var t=e.logs,n=t?M.a.sortBy(t,["date"]).reverse().map((function(e){return r.a.createElement(c.m,{key:e.date},r.a.createElement("div",{className:"note",slot:"start"},D()(e.date).format("DD/MM/YYYY HH:mm:SS")),r.a.createElement(c.n,null,e.type),r.a.createElement("div",{className:"note",slot:"end"},e.data))})):[];return r.a.createElement(c.o,null,n)},L=(n(109),function(){return r.a.createElement(c.o,null,r.a.createElement(c.m,null,r.a.createElement("div",{className:"note",slot:"start"},r.a.createElement(c.w,{animated:!0})),r.a.createElement(c.n,null,r.a.createElement(c.w,{animated:!0,style:{width:"50%"}})),r.a.createElement("div",{className:"note",slot:"end"},r.a.createElement(c.w,{animated:!0}))),r.a.createElement(c.m,null,r.a.createElement("div",{className:"note",slot:"start"},r.a.createElement(c.w,{animated:!0})),r.a.createElement(c.n,null,r.a.createElement(c.w,{animated:!0,style:{width:"50%"}})),r.a.createElement("div",{className:"note",slot:"end"},r.a.createElement(c.w,{animated:!0}))),r.a.createElement(c.m,null,r.a.createElement("div",{className:"note",slot:"start"},r.a.createElement(c.w,{animated:!0})),r.a.createElement(c.n,null,r.a.createElement(c.w,{animated:!0,style:{width:"50%"}})),r.a.createElement("div",{className:"note",slot:"end"},r.a.createElement(c.w,{animated:!0}))))}),q=(n(110),function(){var e=Object(a.useContext)(I),t=e.loading,n=e.lastUpdated,l=e.log;return r.a.createElement(c.t,null,r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.c,{slot:"start"},r.a.createElement(c.q,null)),r.a.createElement(c.z,null,"Logs"),r.a.createElement("div",{slot:"end"},r.a.createElement(_,{lastUpdated:n})))),r.a.createElement(c.i,{fullscreen:!0},t?r.a.createElement(L,null):r.a.createElement(B,{logs:null===l||void 0===l?void 0:l.logs})))}),z=n(87),H=n.n(z),R=(n(184),function(){var e=Object(a.useState)({}),t=Object(h.a)(e,2),n=t[0],l=t[1];return Object(a.useEffect)((function(){(function(){var e=Object(v.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/ypanshin/pi-tree-watering/master/README.md").then((function(e){return e.text()}));case 2:t=(t=e.sent).replace("docs/",""),l({markdown:t});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(c.t,null,r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.c,{slot:"start"},r.a.createElement(c.q,null)),r.a.createElement(c.z,null,"About"))),r.a.createElement(c.i,{fullscreen:!0,className:"ion-padding"},n.markdown?r.a.createElement(H.a,{children:n.markdown}):r.a.createElement(c.w,{animated:!0,style:{width:"100%"}})))}),W=(n(185),function(){var e=Object(a.useContext)(I),t=e.loading,n=e.log;return r.a.createElement(c.t,null,r.a.createElement(c.j,null,r.a.createElement(c.A,null,r.a.createElement(c.c,{slot:"start"},r.a.createElement(c.q,null)),r.a.createElement(c.z,null,"Configuration"))),r.a.createElement(c.i,{fullscreen:!0},r.a.createElement(c.o,null,r.a.createElement(c.m,null,r.a.createElement(c.n,{className:"ion-text-wrap"},r.a.createElement("h2",null,"Moisture Sensor Pin"),r.a.createElement("p",null,"The pin number that the moisture sensor connected to.")),r.a.createElement("div",{className:"note",slot:"end"},t?r.a.createElement(T,null):null===n||void 0===n?void 0:n.config.sensorPin)),r.a.createElement(c.m,null,r.a.createElement(c.n,{className:"ion-text-wrap"},r.a.createElement("h2",null,"Relay GPIO"),r.a.createElement("p",null,"The GPIO number that the relay connected to.")),r.a.createElement("div",{className:"note",slot:"end"},t?r.a.createElement(T,null):null===n||void 0===n?void 0:n.config.relayGpio)),r.a.createElement(c.m,null,r.a.createElement(c.n,{className:"ion-text-wrap"},r.a.createElement("h2",null,"On Interval"),r.a.createElement("p",null,"The interval to check the moisture sensor when relay is on.")),r.a.createElement("div",{className:"note",slot:"end"},t?r.a.createElement(T,null):"".concat(null===n||void 0===n?void 0:n.config.onInterval," ms"))),r.a.createElement(c.m,null,r.a.createElement(c.n,{className:"ion-text-wrap"},r.a.createElement("h2",null,"Off Interval"),r.a.createElement("p",null,"The interval to check the moisture sensor when relay is off.")),r.a.createElement("div",{className:"note",slot:"end"},t?r.a.createElement(T,null):"".concat(null===n||void 0===n?void 0:n.config.offInterval," ms"))),r.a.createElement(c.m,null,r.a.createElement(c.n,{className:"ion-text-wrap"},r.a.createElement("h2",null,"Pump Flow"),r.a.createElement("p",null,"The pump flow.")),r.a.createElement("div",{className:"note",slot:"end"},t?r.a.createElement(T,null):"".concat(null===n||void 0===n?void 0:n.config.pumpFlow," l/min"))))))}),Y=n(88),G=(n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),function(){return r.a.createElement(c.a,null,r.a.createElement(x,null,r.a.createElement(Y.a,null,r.a.createElement(c.x,{contentId:"main"},r.a.createElement(d,null),r.a.createElement(c.v,{id:"main"},r.a.createElement(i.b,{path:"/dashboard",component:C,exact:!0}),r.a.createElement(i.b,{path:"/logs",component:q,exact:!0}),r.a.createElement(i.b,{path:"/config",component:W,exact:!0}),r.a.createElement(i.b,{path:"/about",component:R,exact:!0}),r.a.createElement(i.a,{from:"/",to:"/dashboard",exact:!0}))))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},92:function(e,t,n){e.exports=n(197)},99:function(e,t,n){var a={"./ion-action-sheet.entry.js":[199,5],"./ion-alert.entry.js":[200,6],"./ion-app_8.entry.js":[201,7],"./ion-avatar_3.entry.js":[202,17],"./ion-back-button.entry.js":[203,18],"./ion-backdrop.entry.js":[204,43],"./ion-button_2.entry.js":[205,19],"./ion-card_5.entry.js":[206,20],"./ion-checkbox.entry.js":[207,21],"./ion-chip.entry.js":[208,22],"./ion-col_3.entry.js":[209,44],"./ion-datetime_3.entry.js":[210,10],"./ion-fab_3.entry.js":[211,23],"./ion-img.entry.js":[212,45],"./ion-infinite-scroll_2.entry.js":[213,46],"./ion-input.entry.js":[214,24],"./ion-item-option_3.entry.js":[215,25],"./ion-item_8.entry.js":[216,26],"./ion-loading.entry.js":[217,27],"./ion-menu_3.entry.js":[218,28],"./ion-modal.entry.js":[219,8],"./ion-nav_2.entry.js":[220,14],"./ion-popover.entry.js":[221,9],"./ion-progress-bar.entry.js":[222,29],"./ion-radio_2.entry.js":[223,30],"./ion-range.entry.js":[224,31],"./ion-refresher_2.entry.js":[225,11],"./ion-reorder_2.entry.js":[226,16],"./ion-ripple-effect.entry.js":[227,47],"./ion-route_4.entry.js":[228,32],"./ion-searchbar.entry.js":[229,33],"./ion-segment_2.entry.js":[230,34],"./ion-select_3.entry.js":[231,35],"./ion-slide_2.entry.js":[232,48],"./ion-spinner.entry.js":[233,13],"./ion-split-pane.entry.js":[234,49],"./ion-tab-bar_2.entry.js":[235,36],"./ion-tab_2.entry.js":[236,15],"./ion-text.entry.js":[237,37],"./ion-textarea.entry.js":[238,38],"./ion-toast.entry.js":[239,39],"./ion-toggle.entry.js":[240,12],"./ion-virtual-scroll.entry.js":[241,50]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=99,e.exports=r}},[[92,3,4]]]);
//# sourceMappingURL=main.0bfb6761.chunk.js.map